<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Risk Profili Hesaplayıcı | Yatırım Atlası</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Profesyonel yatırımcı risk profili hesaplayıcı" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>

  <style>
    body { background:#f8f9fa }
  </style>
</head>

<body>
<div class="max-w-3xl mx-auto p-6">

  <div id="app"></div>

</div>

<script>
/* ---------------- DATA ---------------- */

const sections = [
  {
    title: "Risk Alma Kapasitesi",
    weight: 0.20,
    questions: [
      "Geçici %30 kaybı tolere edebilir misiniz?",
      "1 yıl negatif getiri sizin için?",
      "Yüksek volatiliteye yaklaşımınız?",
      "Yüksek riskli yatırımlar?",
      "Piyasa düşüşlerinde davranış?"
    ]
  },
  {
    title: "Finansal Dayanıklılık",
    weight: 0.15,
    questions: [
      "Gelir kesilirse kaç ay?",
      "Borç / gelir oranı?",
      "Portföy likiditesi?",
      "Beklenmedik harcama etkisi?",
      "Gelirin ne kadarı riskte?"
    ]
  },
  {
    title: "Bilgi & Deneyim",
    weight: 0.15,
    questions: [
      "Yatırım deneyimi?",
      "Ürün çeşitliliği?",
      "Diversifikasyon bilgisi?",
      "Makro analiz seviyesi?",
      "Risk-getiri yönetimi?"
    ]
  },
  {
    title: "Psikolojik Dayanıklılık",
    weight: 0.20,
    questions: [
      "Stres seviyesi?",
      "Zarar sonrası davranış?",
      "Haber akışı etkisi?",
      "Kayıpta aksiyon?",
      "Psikolojik güç?"
    ]
  },
  {
    title: "Zaman Ufku",
    weight: 0.15,
    questions: [
      "Yatırım süresi?",
      "Ana yatırım amacı?",
      "Geçici kayıplar?",
      "Nakit akışı önemi?",
      "Plana sadakat?"
    ]
  },
  {
    title: "Volatilite Yönetimi",
    weight: 0.15,
    questions: [
      "Sert hareketler?",
      "Volatilite algısı?",
      "Stop-loss kullanımı?",
      "Dalgalı piyasalar?",
      "Belirsizlikte karar?"
    ]
  }
];

const profiles = [
  { min:0, max:39, name:"Koruyucu", color:"bg-blue-500" },
  { min:40, max:54, name:"Dengeli", color:"bg-green-500" },
  { min:55, max:69, name:"Büyüme Odaklı", color:"bg-yellow-500" },
  { min:70, max:84, name:"Agresif", color:"bg-orange-500" },
  { min:85, max:100, name:"Profesyonel", color:"bg-red-500" }
];

/* ---------------- STATE ---------------- */

let current = 0;
let answers = {};

/* ---------------- UI ---------------- */

const app = document.getElementById("app");

function render() {
  const section = sections[current];

  app.innerHTML = `
    <div class="bg-white p-6 rounded-xl shadow">
      <h1 class="text-2xl font-bold mb-2">Yatırımcı Risk Profili</h1>
      <p class="text-gray-600 mb-6">${current+1} / ${sections.length} — ${section.title}</p>

      ${section.questions.map((q,i)=>`
        <div class="mb-5">
          <p class="font-medium mb-2">${q}</p>
          <div class="flex gap-2">
            ${[1,2,3,4,5].map(v=>`
              <button
                onclick="answer(${current},${i},${v})"
                class="px-3 py-2 rounded border
                ${answers[`${current}-${i}`]==v ? 'bg-blue-600 text-white' : 'bg-white'}">
                ${v}
              </button>
            `).join("")}
          </div>
        </div>
      `).join("")}

      <div class="flex justify-between mt-6">
        <button onclick="prev()" class="px-4 py-2 bg-gray-300 rounded">← Önceki</button>
        ${
          current === sections.length-1
          ? `<button onclick="showResult()" class="px-6 py-2 bg-green-600 text-white rounded">Sonuç</button>`
          : `<button onclick="next()" class="px-6 py-2 bg-blue-600 text-white rounded">Sonraki →</button>`
        }
      </div>
    </div>
  `;
}

function answer(s,q,v){ answers[`${s}-${q}`]=v; render(); }
function next(){ current++; render(); }
function prev(){ current--; render(); }

/* ---------------- RESULT ---------------- */

function showResult(){
  const scores = sections.map((s,si)=>{
    const vals = s.questions.map((_,qi)=>answers[`${si}-${qi}`]||0);
    return (vals.reduce((a,b)=>a+b,0) / (s.questions.length*5)) * 100;
  });

  const total = Math.round(scores.reduce((t,s,i)=>t + s*sections[i].weight,0));
  const profile = profiles.find(p=>total>=p.min && total<=p.max);

  app.innerHTML = `
    <div class="bg-white p-6 rounded-xl shadow">
      <h1 class="text-3xl font-bold text-center mb-2">${total} / 100</h1>
      <p class="text-center text-xl mb-6">${profile.name} Yatırımcı</p>

      <canvas id="radar" height="350"></canvas>

      <div class="text-center mt-6">
        <button onclick="location.reload()" class="px-6 py-2 bg-gray-700 text-white rounded">
          Yeniden Başla
        </button>
      </div>
    </div>
  `;

  new Chart(document.getElementById("radar"), {
    type: "radar",
    data: {
      labels: sections.map(s=>s.title),
      datasets: [{
        label: "Risk Haritası",
        data: scores,
        fill: true,
        backgroundColor: "rgba(37,99,235,0.2)",
        borderColor: "#2563eb"
      }]
    },
    options: {
      scales: { r: { min:0, max:100, ticks:{stepSize:20} } }
    }
  });
}

render();
</script>
</body>
</html>
