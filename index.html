<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Risk Profili | Yatƒ±rƒ±m Atlasƒ±</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}

:root{
  --blue:   #2563eb;
  --blue-s: #eff4ff;
  --ink:    #1a1f36;
  --ink2:   #4a5568;
  --muted:  #94a3b8;
  --border: #e8ecf4;
  --bg:     #ffffff;
  --card:   #ffffff;
  --panel:  #f6f8fe;
  --r:      16px;
}

html, body {
  width: 100%;
  height: 100%;
  font-family: 'Inter', sans-serif;
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
  background: var(--bg);
}

/* QUIZ: page locked, card centered */
html.q { overflow: hidden; }
body.q {
  height: 100%;
  overflow: hidden;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px 16px;
  gap: 12px;
}

/* RESULT: scrollable */
html.r { overflow-y: auto; }
body.r {
  background: var(--panel);
  min-height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 24px 16px 40px;
}

/* ‚îÄ‚îÄ PROGRESS ‚îÄ‚îÄ */
#prog {
  width: 100%;
  max-width: 560px;
  flex-shrink: 0;
}
.pm {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.pm-sec {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: .08em;
  text-transform: uppercase;
  color: var(--blue);
}
.pm-num {
  font-size: 11px;
  font-weight: 600;
  color: var(--muted);
}
.pt { height: 3px; background: var(--border); border-radius: 99px; overflow: hidden; }
.pf {
  height: 100%;
  background: var(--blue);
  border-radius: 99px;
  transition: width .5s cubic-bezier(.4,0,.2,1);
}

/* ‚îÄ‚îÄ QUIZ CARD ‚îÄ‚îÄ */
#card {
  width: 100%;
  max-width: 560px;
  background: var(--card);
  border-radius: var(--r);
  box-shadow:
    0 0 0 1px rgba(37,99,235,.07),
    0 4px 16px rgba(26,31,54,.06),
    0 20px 48px rgba(26,31,54,.07);
  overflow: hidden;
  flex-shrink: 0;
}

/* 3-row grid */
.qg {
  display: grid;
  grid-template-rows: 1fr auto auto;
  height: clamp(360px, 54vh, 490px);
}

/* Question ‚Äî vertically centered */
.qt {
  padding: 28px 28px 22px;
  border-bottom: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  justify-content: center;
  overflow: hidden;
}
.qcat {
  display: inline-flex;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: .1em;
  text-transform: uppercase;
  color: var(--blue);
  background: var(--blue-s);
  padding: 4px 12px;
  border-radius: 99px;
  margin-bottom: 16px;
  width: fit-content;
  flex-shrink: 0;
}
.qtext {
  font-family: 'Playfair Display', serif;
  font-size: clamp(17px, 2.8vw, 22px);
  font-weight: 600;
  line-height: 1.48;
  color: var(--ink);
}

/* Scale */
.sw {
  padding: 16px 28px 18px;
  border-bottom: 1px solid var(--border);
}
.sh {
  display: flex;
  justify-content: space-between;
  font-size: 10.5px;
  color: var(--muted);
  font-weight: 500;
  margin-bottom: 11px;
}
.sr { display: flex; gap: 8px; }
.sr button {
  flex: 1;
  height: 56px;
  border-radius: 12px;
  border: 1.5px solid var(--border);
  background: #fff;
  font-size: 18px;
  font-weight: 700;
  font-family: 'Inter', sans-serif;
  color: var(--ink2);
  cursor: pointer;
  transition: all .14s ease;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}
.sr button:hover {
  border-color: var(--blue);
  color: var(--blue);
  background: var(--blue-s);
}
.sr button:active { transform: scale(.91); }
.sr button.sel {
  background: var(--blue);
  color: #fff;
  border-color: var(--blue);
  box-shadow: 0 4px 16px rgba(37,99,235,.32);
  transform: translateY(-2px);
}

/* Nav */
.nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 24px;
  height: 68px;
}
.bb {
  font-size: 14px;
  font-weight: 500;
  color: var(--muted);
  background: none;
  border: none;
  cursor: pointer;
  font-family: 'Inter', sans-serif;
  padding: 8px 4px;
  transition: color .12s;
  -webkit-tap-highlight-color: transparent;
}
.bb:hover { color: var(--ink); }
.bb:disabled { opacity: .2; cursor: default; }
.bn {
  font-size: 14px;
  font-weight: 700;
  font-family: 'Inter', sans-serif;
  color: #fff;
  background: var(--blue);
  border: none;
  border-radius: 11px;
  padding: 12px 28px;
  cursor: pointer;
  transition: all .14s;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}
.bn:hover { background: #1d4ed8; }
.bn:active { transform: scale(.96); }

/* ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ */
.lw { padding: 34px 28px 38px; }
.lw h2 {
  font-family: 'Playfair Display', serif;
  font-size: clamp(22px, 4vw, 27px);
  font-weight: 700;
  margin-bottom: 7px;
  color: var(--ink);
}
.lw p {
  font-size: 13.5px;
  color: var(--muted);
  line-height: 1.65;
  margin-bottom: 26px;
}
.fi {
  width: 100%;
  padding: 13px 15px;
  border: 1.5px solid var(--border);
  border-radius: 11px;
  font-size: 14px;
  font-family: 'Inter', sans-serif;
  color: var(--ink);
  background: #fff;
  outline: none;
  transition: border-color .14s, box-shadow .14s;
  margin-bottom: 10px;
  -webkit-appearance: none;
}
.fi:focus {
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(37,99,235,.1);
}
.ls {
  width: 100%;
  padding: 14px;
  background: var(--blue);
  color: #fff;
  border: none;
  border-radius: 11px;
  font-size: 14px;
  font-weight: 700;
  font-family: 'Inter', sans-serif;
  cursor: pointer;
  margin-top: 4px;
  transition: all .14s;
  letter-spacing: .01em;
  -webkit-tap-highlight-color: transparent;
}
.ls:hover { background: #1d4ed8; }
.ls:active { transform: scale(.98); }

/* ‚îÄ‚îÄ RESULT ‚îÄ‚îÄ */
.rc {
  width: 100%;
  max-width: 560px;
  background: var(--card);
  border-radius: var(--r);
  box-shadow:
    0 0 0 1px rgba(37,99,235,.07),
    0 4px 16px rgba(26,31,54,.06),
    0 20px 48px rgba(26,31,54,.07);
  overflow: hidden;
}

.rh {
  padding: 22px 24px 20px;
  display: flex;
  align-items: center;
  gap: 16px;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}
.ri { font-size: 38px; line-height: 1; flex-shrink: 0; }
.rl { font-size: 10px; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; color: var(--muted); margin-bottom: 2px; }
.rn { font-family: 'Playfair Display', serif; font-size: clamp(20px, 4vw, 25px); font-weight: 700; color: var(--ink); }
.rsc { font-size: 11.5px; color: var(--muted); margin-top: 3px; }

.rs2 { padding: 16px 24px; border-bottom: 1px solid var(--border); }
.st { font-size: 10px; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; color: var(--muted); margin-bottom: 10px; }

.gl { display: flex; justify-content: space-between; font-size: 10.5px; color: var(--muted); font-weight: 500; margin-bottom: 8px; }
.gtr { height: 9px; background: var(--border); border-radius: 99px; overflow: hidden; }
.gfi { height: 100%; border-radius: 99px; width: 0%; transition: width 1.2s cubic-bezier(.4,0,.2,1) .3s; }

.zones { display: flex; gap: 5px; margin-top: 10px; }
.zone { flex: 1; text-align: center; padding: 6px 2px; border-radius: 8px; font-size: 9.5px; font-weight: 700; letter-spacing: .02em; border: 2px solid transparent; transition: transform .2s; }
.z1{background:#dcfce7;color:#15803d;}
.z2{background:#fef9c3;color:#a16207;}
.z3{background:#dbeafe;color:#1d4ed8;}
.z4{background:#fee2e2;color:#b91c1c;}
.zon { border-color: currentColor; transform: translateY(-1px); }

.cb { height: 230px; position: relative; }
@media(min-width:500px){ .cb{ height: 270px; } }

.dc { background: var(--panel); border-radius: 10px; padding: 14px 16px; font-size: 13.5px; color: var(--ink2); line-height: 1.7; margin-bottom: 10px; }
.dc:last-child { margin-bottom: 0; }
.dc b { display: block; font-size: 10px; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; color: var(--muted); margin-bottom: 5px; }

.al { display: flex; flex-wrap: wrap; gap: 7px; }
.ap { display: flex; align-items: center; gap: 7px; padding: 6px 13px; border-radius: 99px; font-size: 12px; font-weight: 600; border: 1.5px solid var(--border); background: #fff; }
.ad { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }

.rbtn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  margin: 14px 24px 22px;
  width: calc(100% - 48px);
  padding: 13px;
  border-radius: 11px;
  background: var(--panel);
  border: 1.5px solid var(--border);
  font-size: 13.5px; font-weight: 600;
  font-family: 'Inter', sans-serif;
  color: var(--ink2); cursor: pointer;
  transition: all .14s;
  -webkit-tap-highlight-color: transparent;
}
.rbtn:hover { background: var(--border); color: var(--ink); }
.rbtn:active { transform: scale(.98); }

/* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
@keyframes sR{from{opacity:0;transform:translateX(24px);}to{opacity:1;transform:translateX(0);}}
@keyframes sL{from{opacity:0;transform:translateX(-24px);}to{opacity:1;transform:translateX(0);}}
@keyframes fU{from{opacity:0;transform:translateY(14px);}to{opacity:1;transform:translateY(0);}}
@keyframes shk{0%,100%{transform:translateX(0);}25%{transform:translateX(-7px);}75%{transform:translateX(7px);}}
.aR{animation:sR .22s ease forwards;}
.aL{animation:sL .22s ease forwards;}
.aU{animation:fU .28s ease forwards;}
.shk{animation:shk .22s ease;}
</style>
</head>
<body class="q">

<div id="prog">
  <div class="pm">
    <span class="pm-sec" id="psec">Risk Algƒ±sƒ±</span>
    <span class="pm-num" id="pnum">1 / 30</span>
  </div>
  <div class="pt"><div class="pf" id="pf"></div></div>
</div>

<div id="card"></div>

<script>
const SEC=[
  {title:"Risk Algƒ±sƒ±",         short:"Risk",      color:"#6366f1",q:[
    "Piyasa %20 d√º≈üt√ºƒü√ºnde pozisyonumu koruyabilirim.",
    "Ge√ßici zararlar beni paniƒüe s√ºr√ºklemez.",
    "Dalgalƒ± piyasalarda sakin kalƒ±rƒ±m.",
    "Portf√∂y d√º≈ü√º≈ülerinde stratejimi bozmam.",
    "Belirsizlik d√∂nemlerinde yatƒ±rƒ±m yapabilirim."
  ]},
  {title:"Volatilite Toleransƒ±",short:"Volatilite",color:"#8b5cf6",q:[
    "Y√ºksek getiri i√ßin risk alabilirim.",
    "G√ºnl√ºk fiyat deƒüi≈üimleri beni rahatsƒ±z etmez.",
    "Agresif yatƒ±rƒ±m ara√ßlarƒ±na a√ßƒ±ƒüƒ±m.",
    "Kƒ±sa vadeli kayƒ±plarƒ± tolere edebilirim.",
    "Oynaklƒ±k benim i√ßin fƒ±rsattƒ±r."
  ]},
  {title:"Zaman Ufku",          short:"Zaman",     color:"#3b82f6",q:[
    "Yatƒ±rƒ±mlarƒ±mƒ± uzun vadeli planlarƒ±m.",
    "En az 5 yƒ±l yatƒ±rƒ±mda kalabilirim.",
    "Sabƒ±rlƒ± bir yatƒ±rƒ±mcƒ±yƒ±m.",
    "Kƒ±sa vadeli kazan√ß √∂nceliƒüim deƒüildir.",
    "Uzun s√ºre bekleyebilirim."
  ]},
  {title:"Finansal G√º√ß",        short:"Finansal",  color:"#10b981",q:[
    "Acil durum fonum mevcut.",
    "Bor√ß oranƒ±m d√º≈ü√ºk.",
    "Gelirim d√ºzenli ve istikrarlƒ±.",
    "Yatƒ±rƒ±m zararlarƒ± g√ºnl√ºk hayatƒ±mƒ± etkilemez.",
    "Nakit ihtiyacƒ±m d√º≈ü√ºk seviyede."
  ]},
  {title:"Bilgi & Deneyim",     short:"Bilgi",     color:"#f59e0b",q:[
    "Yatƒ±rƒ±m piyasalarƒ± hakkƒ±nda bilgim var.",
    "Daha √∂nce yatƒ±rƒ±m deneyimim oldu.",
    "Risk-getiri ili≈ükisini iyi bilirim.",
    "Farklƒ± varlƒ±k t√ºrlerini tanƒ±rƒ±m.",
    "Piyasa analizlerini d√ºzenli takip ederim."
  ]},
  {title:"Davranƒ±≈üsal Disiplin",short:"Disiplin",  color:"#ef4444",q:[
    "Piyasa d√º≈ü√º≈ülerinde panik satƒ±≈ü yapmam.",
    "S√ºr√º psikolojisinden etkilenmem.",
    "Belirlediƒüim stratejiye sadƒ±k kalƒ±rƒ±m.",
    "Duygularƒ±mƒ± yatƒ±rƒ±m kararlarƒ±ndan ayƒ±rƒ±rƒ±m.",
    "A≈üƒ±rƒ± √∂zg√ºvenle karar vermekten ka√ßƒ±nƒ±rƒ±m."
  ]}
];

const AQ=[];
SEC.forEach((s,si)=>s.q.forEach((q,qi)=>AQ.push({s,si,qi,q})));
const TOT=AQ.length;

const PROF=[
  {min:30, max:74,  name:"Koruma Odaklƒ±", icon:"üõ°Ô∏è", zone:0,
   g1:"#bbf7d0",g2:"#22c55e",
   desc:"Sermayenizi korumayƒ± √∂n planda tutuyorsunuz. G√ºvenli, istikrarlƒ± varlƒ±klara y√∂neliyorsunuz.",
   sug:"Devlet tahvili, mevduat, altƒ±n ve d√º≈ü√ºk volatiliteli fonlar portf√∂y√ºn√ºz√ºn temelini olu≈üturabilir.",
   al:[{l:"Tahvil/Mevduat",p:"50%",c:"#4ade80"},{l:"Altƒ±n",p:"25%",c:"#fbbf24"},{l:"Hisse",p:"15%",c:"#60a5fa"},{l:"Diƒüer",p:"10%",c:"#a78bfa"}]},
  {min:75, max:104, name:"Dengeli",       icon:"‚öñÔ∏è", zone:1,
   g1:"#fef08a",g2:"#f59e0b",
   desc:"Risk ve getiriyi dengelemeyi tercih ediyorsunuz. Makul getiri i√ßin sƒ±nƒ±rlƒ± d√º≈ü√º≈üleri kaldƒ±rabilirsiniz.",
   sug:"Karma portf√∂y, temett√º hisseleri ve orta vadeli tahvil kombinasyonu size uygundur.",
   al:[{l:"Hisse",p:"40%",c:"#60a5fa"},{l:"Tahvil",p:"35%",c:"#4ade80"},{l:"Altƒ±n",p:"15%",c:"#fbbf24"},{l:"Diƒüer",p:"10%",c:"#a78bfa"}]},
  {min:105,max:134, name:"B√ºy√ºme Odaklƒ±",icon:"üìà", zone:2,
   g1:"#bfdbfe",g2:"#3b82f6",
   desc:"Uzun vadeli b√ºy√ºme i√ßin ge√ßici dalgalanmalarƒ± kaldƒ±rabiliyorsunuz. Bilin√ßli ve disiplinli risk alƒ±yorsunuz.",
   sug:"Hisse aƒüƒ±rlƒ±klƒ±, √ße≈üitlendirilmi≈ü portf√∂y. B√ºy√ºme hisseleri ve geli≈ümekte olan piyasalar radarƒ±nƒ±zda.",
   al:[{l:"Hisse",p:"60%",c:"#60a5fa"},{l:"Tahvil",p:"20%",c:"#4ade80"},{l:"Altƒ±n",p:"10%",c:"#fbbf24"},{l:"Kripto/Diƒüer",p:"10%",c:"#a78bfa"}]},
  {min:135,max:150, name:"Agresif",       icon:"üöÄ", zone:3,
   g1:"#fecaca",g2:"#ef4444",
   desc:"Y√ºksek getiri i√ßin y√ºksek riski g√∂ze alabiliyorsunuz. Volatiliteyi fƒ±rsat olarak g√∂r√ºyorsunuz.",
   sug:"Y√ºksek b√ºy√ºme potansiyelli hisseler, kripto para ve alternatif yatƒ±rƒ±m ara√ßlarƒ± profilinize uygun.",
   al:[{l:"Hisse",p:"70%",c:"#60a5fa"},{l:"Kripto",p:"15%",c:"#a78bfa"},{l:"Tahvil",p:"10%",c:"#4ade80"},{l:"Diƒüer",p:"5%",c:"#fbbf24"}]}
];

let cur=0,ans={},user=null,rch=null;
const H=document.documentElement;
const B=document.body;
const card=document.getElementById("card");
const prog=document.getElementById("prog");
const pf=document.getElementById("pf");
const psec=document.getElementById("psec");
const pnum=document.getElementById("pnum");

function notify(){
  try{
    const h=B.classList.contains("r")
      ?Math.max(H.scrollHeight,B.scrollHeight)
      :B.offsetHeight;
    window.parent.postMessage({type:"iframeResize",height:h+10},"*");
  }catch(e){}
}

function upProg(){
  const p=((cur+1)/TOT)*100;
  pf.style.width=Math.max(p,3.3)+"%";
  // progress bar section ve sayƒ± ayrƒ± elementlerde ‚Äî birle≈ümez
  psec.textContent=AQ[Math.min(cur,TOT-1)].s.title;
  pnum.textContent=(cur+1)+" / "+TOT;
}

function quizMode(){
  H.className="q"; B.className="q";
  prog.style.display="";
  setTimeout(notify,60);
}

function resultMode(){
  H.className="r"; B.className="r";
  prog.style.display="none";
  setTimeout(notify,400);
}

function an(el,c){
  el.classList.remove("aR","aL","aU","shk");
  void el.offsetWidth;
  if(c) el.classList.add(c);
}

function renderQ(dir){
  upProg();
  quizMode();
  const item=AQ[cur];
  const sel=ans[cur];
  const last=cur===TOT-1;
  card.className="";
  card.innerHTML=`
    <div class="qg">
      <div class="qt">
        <div class="qcat">${item.s.title}</div>
        <div class="qtext">${item.q}</div>
      </div>
      <div class="sw">
        <div class="sh">
          <span>1 ‚Äî Hi√ß rahat deƒüilim</span>
          <span>5 ‚Äî √áok rahatƒ±m</span>
        </div>
        <div class="sr">
          ${[1,2,3,4,5].map(v=>`<button class="${sel===v?"sel":""}" onclick="pick(${v})">${v}</button>`).join("")}
        </div>
      </div>
      <div class="nav">
        <button class="bb" onclick="goBack()" ${cur===0?"disabled":""}>‚Üê Geri</button>
        <button class="bn" onclick="goNext()">${last?"Sonucu G√∂r ‚ú¶":"ƒ∞leri ‚Üí"}</button>
      </div>
    </div>`;
  an(card,dir==="R"?"aR":dir==="L"?"aL":null);
}

function pick(v){
  ans[cur]=v;
  document.querySelectorAll(".sr button").forEach((b,i)=>{
    b.className=(i+1===v)?"sel":"";
  });
}

function goNext(){
  if(!ans[cur]){an(card,"shk");return;}
  if(cur<TOT-1){cur++;renderQ("R");}
  else showLogin();
}

function goBack(){
  if(cur>0){cur--;renderQ("L");}
}

function showLogin(){
  quizMode();
  prog.style.display="none";
  card.innerHTML=`
    <div class="lw">
      <h2>Son bir adƒ±m.</h2>
      <p>Sonucunuzu g√∂rmek i√ßin bilgilerinizi girin. Verileriniz yalnƒ±zca profilinizi kaydetmek amacƒ±yla kullanƒ±lƒ±r.</p>
      <input class="fi" id="fn" type="text"  placeholder="Ad Soyad"       autocomplete="name"/>
      <input class="fi" id="fe" type="email" placeholder="E-posta adresi" autocomplete="email"/>
      <button class="ls" onclick="doLogin()">Sonucumu G√∂r ‚Üí</button>
    </div>`;
  an(card,"aR");
  setTimeout(()=>{const e=document.getElementById("fn");if(e)e.focus();},300);
}

function doLogin(){
  const n=(document.getElementById("fn").value||"").trim();
  const e=(document.getElementById("fe").value||"").trim();
  if(!n||!e||!e.includes("@")){
    const b=document.querySelector(".ls");
    b.style.background="#ef4444";
    b.textContent="L√ºtfen bilgileri eksiksiz doldurun";
    setTimeout(()=>{b.style.background="";b.textContent="Sonucumu G√∂r ‚Üí";},1600);
    return;
  }
  user={name:n,email:e};
  localStorage.setItem("rp_u",JSON.stringify(user));
  const sv=localStorage.getItem("rp_r_"+e);
  if(sv) showResult(JSON.parse(sv));
  else compute();
}

function compute(){
  const total=Object.values(ans).reduce((a,b)=>a+b,0);
  const ss=SEC.map((_,si)=>{
    let s=0;for(let q=0;q<5;q++)s+=(ans[si*5+q]||1);
    return Math.round((s/25)*100);
  });
  const p=PROF.find(x=>total>=x.min&&total<=x.max)||PROF[PROF.length-1];
  const d={
    name:user.name,email:user.email,total,ss,
    pname:p.name,icon:p.icon,desc:p.desc,sug:p.sug,
    al:p.al,g1:p.g1,g2:p.g2,zone:p.zone,
    date:new Date().toISOString()
  };
  localStorage.setItem("rp_r_"+user.email,JSON.stringify(d));
  showResult(d);
}

function showResult(d){
  resultMode();
  const pct=Math.round(((d.total-30)/120)*100);
  const zones=["Koruma","Dengeli","B√ºy√ºme","Agresif"];
  card.className="rc";
  card.innerHTML=`
    <div class="rh">
      <div class="ri">${d.icon}</div>
      <div>
        <div class="rl">Risk Profiliniz</div>
        <div class="rn">${d.pname}</div>
        <div class="rsc">Skor: ${d.total} / 150 ¬∑ ${d.name}</div>
      </div>
    </div>
    <div class="rs2">
      <div class="st">Risk Seviyesi</div>
      <div class="gl"><span>D√º≈ü√ºk Risk</span><span>Y√ºksek Risk</span></div>
      <div class="gtr"><div class="gfi" id="gf" style="background:linear-gradient(90deg,${d.g1},${d.g2})"></div></div>
      <div class="zones">${zones.map((z,i)=>`<div class="zone z${i+1}${i===d.zone?" zon":""}">${z}</div>`).join("")}</div>
    </div>
    <div class="rs2">
      <div class="st">Kategori Bazlƒ± Analiz</div>
      <div class="cb"><canvas id="rcv"></canvas></div>
    </div>
    <div class="rs2">
      <div class="dc"><b>Profil A√ßƒ±klamasƒ±</b>${d.desc}</div>
      <div class="dc"><b>√ñnerilen Yakla≈üƒ±m</b>${d.sug}</div>
    </div>
    <div class="rs2">
      <div class="st" style="margin-bottom:10px">√ñrnek Portf√∂y Daƒüƒ±lƒ±mƒ±</div>
      <div class="al">${(d.al||[]).map(a=>`<div class="ap"><div class="ad" style="background:${a.c}"></div><span>${a.l} <strong>${a.p}</strong></span></div>`).join("")}</div>
    </div>
    <button class="rbtn" onclick="reset()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-4"/>
      </svg>
      Testi Yeniden Ba≈ülat
    </button>`;
  an(card,"aU");

  requestAnimationFrame(()=>requestAnimationFrame(()=>{
    const f=document.getElementById("gf");
    if(f) f.style.width=pct+"%";
  }));

  setTimeout(()=>{
    const cv=document.getElementById("rcv");
    if(!cv) return;
    if(rch){rch.destroy();rch=null;}
    rch=new Chart(cv,{
      type:"radar",
      data:{
        labels:SEC.map(s=>s.short),
        datasets:[{
          data:d.ss,fill:true,
          backgroundColor:ha(d.g2,.14),
          borderColor:d.g2,borderWidth:2.5,
          pointBackgroundColor:d.g2,pointRadius:4.5,pointHoverRadius:7
        }]
      },
      options:{
        responsive:true,maintainAspectRatio:false,
        layout:{padding:{top:8,bottom:8,left:14,right:14}},
        plugins:{legend:{display:false},tooltip:{callbacks:{label:c=>` ${c.raw}%`}}},
        scales:{r:{
          min:0,max:100,
          ticks:{stepSize:25,font:{size:9},color:"#94a3b8",backdropColor:"transparent"},
          grid:{color:"#e8ecf4"},angleLines:{color:"#e8ecf4"},
          pointLabels:{font:{size:11,family:"'Inter',sans-serif",weight:"600"},color:"#4a5568",padding:12}
        }}
      }
    });
    setTimeout(notify,200);
  },380);
}

function ha(h,a){
  return`rgba(${parseInt(h.slice(1,3),16)},${parseInt(h.slice(3,5),16)},${parseInt(h.slice(5,7),16)},${a})`;
}

function reset(){
  if(rch){rch.destroy();rch=null;}
  if(user) localStorage.removeItem("rp_r_"+user.email);
  card.className=""; ans={}; cur=0; user=null;
  renderQ(null);
}

(function(){
  const su=localStorage.getItem("rp_u");
  if(su){
    user=JSON.parse(su);
    const sr=localStorage.getItem("rp_r_"+user.email);
    if(sr){showResult(JSON.parse(sr));return;}
  }
  renderQ(null);
})();
</script>
</body>
</html>
