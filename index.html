<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Risk Profili | YatÄ±rÄ±m AtlasÄ±</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}

:root{
  --bg:       #ffffff;
  --quiz-bg:  #f4f6fb;   /* quiz ekranÄ± arka planÄ± â€” site mavimsi tonu */
  --card:     #ffffff;
  --ink:      #1a1f36;
  --ink2:     #4a5568;
  --muted:    #9aa5b4;
  --border:   #e2e8f0;
  --blue:     #2563eb;
  --blue-s:   #eff4ff;
  --r:        16px;
  --card-h:   340px;     /* quiz kartÄ± sabit yÃ¼kseklik */
}

html,body{
  width:100%;
  background:var(--bg);
  font-family:'Inter',sans-serif;
  color:var(--ink);
  -webkit-font-smoothing:antialiased;
}

/* â”€â”€ QUIZ MODE: full viewport, centered, no scroll â”€â”€ */
body.mode-quiz{
  height:100dvh;
  overflow:hidden;
  background:var(--quiz-bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:16px;
  gap:10px;
}

/* â”€â”€ RESULT MODE: normal scroll â”€â”€ */
body.mode-result{
  min-height:100dvh;
  overflow-y:auto;
  background:var(--bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px 16px 36px;
  gap:0;
}

/* â•â• PROGRESS BAR â•â• */
#prog-wrap{
  width:100%;
  max-width:480px;
  flex-shrink:0;
}
.prog-meta{
  display:flex;
  justify-content:space-between;
  font-size:11px;
  font-weight:700;
  color:var(--muted);
  letter-spacing:.05em;
  text-transform:uppercase;
  margin-bottom:6px;
}
.prog-track{
  height:3px;
  background:var(--border);
  border-radius:99px;
  overflow:hidden;
}
.prog-fill{
  height:100%;
  background:var(--blue);
  border-radius:99px;
  transition:width .45s cubic-bezier(.4,0,.2,1);
}

/* â•â• QUIZ CARD â€” FIXED HEIGHT â•â• */
#card{
  width:100%;
  max-width:480px;
  background:var(--card);
  border-radius:var(--r);
  box-shadow:0 2px 8px rgba(26,31,54,.06), 0 8px 32px rgba(26,31,54,.08);
  overflow:hidden;
}

/* Quiz card inner grid: 3 rows, fixed */
.quiz-grid{
  display:grid;
  grid-template-rows:1fr auto auto;
  height:var(--card-h);
}

/* Question header â€” flexible, no overflow */
.q-top{
  padding:22px 24px 16px;
  border-bottom:1px solid var(--border);
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  overflow:hidden;
}
.q-cat{
  display:inline-flex;
  align-items:center;
  font-size:10px;
  font-weight:700;
  letter-spacing:.1em;
  text-transform:uppercase;
  color:var(--blue);
  background:var(--blue-s);
  padding:3px 10px;
  border-radius:99px;
  margin-bottom:12px;
  width:fit-content;
}
.q-text{
  font-family:'Playfair Display',serif;
  font-size:clamp(15px,3.8vw,18px);
  font-weight:600;
  line-height:1.45;
  color:var(--ink);
  overflow:hidden;
  display:-webkit-box;
  -webkit-line-clamp:4;
  -webkit-box-orient:vertical;
}

/* Scale row â€” fixed height */
.scale-wrap{
  padding:14px 24px 16px;
  border-bottom:1px solid var(--border);
}
.scale-hint{
  display:flex;
  justify-content:space-between;
  font-size:10px;
  color:var(--muted);
  font-weight:500;
  margin-bottom:10px;
}
.scale-row{
  display:flex;
  gap:8px;
}
.scale-row button{
  flex:1;
  height:48px;
  border-radius:10px;
  border:1.5px solid var(--border);
  background:#fff;
  font-size:16px;
  font-weight:700;
  font-family:'Inter',sans-serif;
  color:var(--ink2);
  cursor:pointer;
  transition:all .12s ease;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.scale-row button:active{transform:scale(.93);}
.scale-row button.sel{
  background:var(--blue);
  color:#fff;
  border-color:var(--blue);
  box-shadow:0 3px 10px rgba(37,99,235,.28);
  transform:translateY(-1px);
}

/* Nav â€” fixed height */
.nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 20px 14px;
  gap:8px;
}
.btn-back{
  font-size:13px;
  font-weight:500;
  color:var(--muted);
  background:none;
  border:none;
  cursor:pointer;
  padding:8px 6px;
  font-family:'Inter',sans-serif;
  transition:color .12s;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.btn-back:hover{color:var(--ink);}
.btn-back:disabled{opacity:.25;cursor:default;}
.btn-next{
  font-size:13px;
  font-weight:700;
  font-family:'Inter',sans-serif;
  color:#fff;
  background:var(--blue);
  border:none;
  border-radius:10px;
  padding:11px 22px;
  cursor:pointer;
  transition:all .12s;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  letter-spacing:.01em;
}
.btn-next:active{transform:scale(.96);}

/* â•â• LOGIN â•â• */
.login-wrap{padding:28px 24px;}
.login-wrap h2{
  font-family:'Playfair Display',serif;
  font-size:clamp(20px,5vw,24px);
  font-weight:700;
  margin-bottom:6px;
  color:var(--ink);
}
.login-wrap p{
  font-size:13px;
  color:var(--muted);
  line-height:1.6;
  margin-bottom:22px;
}
.field{
  width:100%;
  padding:12px 14px;
  border:1.5px solid var(--border);
  border-radius:10px;
  font-size:14px;
  font-family:'Inter',sans-serif;
  color:var(--ink);
  background:#fff;
  outline:none;
  transition:border-color .12s;
  margin-bottom:10px;
  -webkit-appearance:none;
  touch-action:manipulation;
}
.field:focus{border-color:var(--blue);}
.btn-submit{
  width:100%;
  padding:13px;
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:10px;
  font-size:14px;
  font-weight:700;
  font-family:'Inter',sans-serif;
  cursor:pointer;
  margin-top:4px;
  transition:all .12s;
  letter-spacing:.01em;
  -webkit-tap-highlight-color:transparent;
}
.btn-submit:active{transform:scale(.98);}

/* â•â• RESULT â•â• */
.result-card{
  width:100%;
  max-width:480px;
  background:var(--card);
  border-radius:var(--r);
  box-shadow:0 2px 8px rgba(26,31,54,.06), 0 8px 32px rgba(26,31,54,.08);
  overflow:hidden;
  margin-top:0;
}

.result-header{
  padding:22px 22px 18px;
  display:flex;
  align-items:center;
  gap:14px;
  border-bottom:1px solid var(--border);
}
.result-icon{font-size:36px;line-height:1;flex-shrink:0;}
.result-info{}
.result-label{
  font-size:10px;font-weight:700;
  letter-spacing:.1em;text-transform:uppercase;
  color:var(--muted);margin-bottom:2px;
}
.result-name{
  font-family:'Playfair Display',serif;
  font-size:clamp(19px,5vw,24px);
  font-weight:700;color:var(--ink);
}
.result-score-tag{
  display:inline-block;
  font-size:11px;color:var(--muted);
  background:var(--quiz-bg);
  padding:2px 10px;border-radius:99px;
  margin-top:3px;
}

/* Gauge */
.section-block{padding:16px 22px;border-bottom:1px solid var(--border);}
.section-title{
  font-size:10px;font-weight:700;
  letter-spacing:.1em;text-transform:uppercase;
  color:var(--muted);margin-bottom:10px;
}
.gauge-labels{
  display:flex;justify-content:space-between;
  font-size:10px;color:var(--muted);
  font-weight:500;margin-bottom:7px;
}
.gauge-track{
  height:8px;background:var(--border);
  border-radius:99px;overflow:hidden;position:relative;
}
.gauge-fill{
  height:100%;border-radius:99px;
  transition:width 1.1s cubic-bezier(.4,0,.2,1) .3s;
}
.zones{
  display:flex;gap:4px;margin-top:10px;
}
.zone{
  flex:1;text-align:center;padding:5px 2px;
  border-radius:7px;font-size:9px;font-weight:700;
  letter-spacing:.02em;border:2px solid transparent;
  transition:all .2s;
}
.zone.z1{background:#dcfce7;color:#15803d;}
.zone.z2{background:#fef9c3;color:#92400e;}
.zone.z3{background:#dbeafe;color:#1d4ed8;}
.zone.z4{background:#fee2e2;color:#b91c1c;}
.zone.active{border-color:currentColor;transform:translateY(-1px);}

/* Radar */
.chart-box{height:220px;position:relative;padding:4px 0;}

/* Desc cards */
.desc-block{
  background:var(--quiz-bg);
  border-radius:10px;padding:14px 16px;
  font-size:13px;color:var(--ink2);line-height:1.65;
  margin-bottom:10px;
}
.desc-block b{
  display:block;font-size:10px;font-weight:700;
  letter-spacing:.1em;text-transform:uppercase;
  color:var(--muted);margin-bottom:5px;
}

/* Alloc */
.alloc-grid{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:4px;}
.alloc-pill{
  display:flex;align-items:center;gap:6px;
  padding:6px 12px;border-radius:99px;
  font-size:12px;font-weight:600;
  border:1.5px solid var(--border);background:#fff;
}
.alloc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}

/* Restart button */
.restart-btn{
  display:flex;align-items:center;justify-content:center;gap:8px;
  width:calc(100% - 44px);margin:16px 22px 22px;
  padding:13px;border-radius:10px;
  background:var(--quiz-bg);border:1.5px solid var(--border);
  font-size:13px;font-weight:600;font-family:'Inter',sans-serif;
  color:var(--ink2);cursor:pointer;transition:all .12s;
  -webkit-tap-highlight-color:transparent;
}
.restart-btn:hover{background:var(--border);color:var(--ink);}
.restart-btn:active{transform:scale(.98);}
.restart-btn svg{flex-shrink:0;}

/* â•â• ANIMATIONS â•â• */
@keyframes slideR{from{opacity:0;transform:translateX(22px);}to{opacity:1;transform:translateX(0);}}
@keyframes slideL{from{opacity:0;transform:translateX(-22px);}to{opacity:1;transform:translateX(0);}}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px);}to{opacity:1;transform:translateY(0);}}
@keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-7px);}75%{transform:translateX(7px);}}
.aR{animation:slideR .2s ease forwards;}
.aL{animation:slideL .2s ease forwards;}
.aU{animation:fadeUp .28s ease forwards;}
.shake{animation:shake .22s ease;}
</style>
</head>
<body class="mode-quiz">

<div id="prog-wrap">
  <div class="prog-meta">
    <span id="p-section">Risk AlgÄ±sÄ±</span>
    <span id="p-num">1 / 30</span>
  </div>
  <div class="prog-track"><div class="prog-fill" id="p-fill" style="width:3.3%"></div></div>
</div>

<div id="card"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SECTIONS=[
  {key:"risk",  title:"Risk AlgÄ±sÄ±",         short:"Risk",     color:"#6366f1", questions:[
    "Piyasa %20 dÃ¼ÅŸtÃ¼ÄŸÃ¼nde pozisyonumu koruyabilirim.",
    "GeÃ§ici zararlar beni paniÄŸe sÃ¼rÃ¼klemez.",
    "DalgalÄ± piyasalarda sakin kalÄ±rÄ±m.",
    "PortfÃ¶y dÃ¼ÅŸÃ¼ÅŸlerinde stratejimi bozmam.",
    "Belirsizlik dÃ¶nemlerinde yatÄ±rÄ±m yapabilirim."
  ]},
  {key:"volat", title:"Volatilite ToleransÄ±",short:"Volatilite",color:"#8b5cf6", questions:[
    "YÃ¼ksek getiri iÃ§in risk alabilirim.",
    "GÃ¼nlÃ¼k fiyat deÄŸiÅŸimleri beni rahatsÄ±z etmez.",
    "Agresif yatÄ±rÄ±m araÃ§larÄ±na aÃ§Ä±ÄŸÄ±m.",
    "KÄ±sa vadeli kayÄ±plarÄ± tolere edebilirim.",
    "OynaklÄ±k benim iÃ§in fÄ±rsat demektir."
  ]},
  {key:"zaman", title:"Zaman Ufku",          short:"Zaman",    color:"#3b82f6", questions:[
    "YatÄ±rÄ±mlarÄ±mÄ± uzun vadeli planlarÄ±m.",
    "En az 5 yÄ±l yatÄ±rÄ±mda kalabilirim.",
    "SabÄ±rlÄ± bir yatÄ±rÄ±mcÄ±yÄ±m.",
    "KÄ±sa vadeli kazanÃ§ Ã¶nceliÄŸim deÄŸildir.",
    "Uzun sÃ¼re bekleyebilirim."
  ]},
  {key:"dayn",  title:"Finansal GÃ¼Ã§",        short:"Finansal", color:"#10b981", questions:[
    "Acil durum fonum mevcut.",
    "BorÃ§ oranÄ±m dÃ¼ÅŸÃ¼k.",
    "Gelirim dÃ¼zenli ve istikrarlÄ±.",
    "YatÄ±rÄ±m zararlarÄ± gÃ¼nlÃ¼k hayatÄ±mÄ± etkilemez.",
    "Nakit ihtiyacÄ±m dÃ¼ÅŸÃ¼k seviyede."
  ]},
  {key:"bilgi", title:"Bilgi & Deneyim",     short:"Bilgi",    color:"#f59e0b", questions:[
    "YatÄ±rÄ±m piyasalarÄ± hakkÄ±nda bilgim var.",
    "Daha Ã¶nce yatÄ±rÄ±m deneyimim oldu.",
    "Risk-getiri iliÅŸkisini iyi bilirim.",
    "FarklÄ± varlÄ±k tÃ¼rlerini tanÄ±rÄ±m.",
    "Piyasa analizlerini dÃ¼zenli takip ederim."
  ]},
  {key:"davr",  title:"DavranÄ±ÅŸsal Disiplin",short:"Disiplin", color:"#ef4444", questions:[
    "Piyasa dÃ¼ÅŸÃ¼ÅŸlerinde panik satÄ±ÅŸ yapmam.",
    "SÃ¼rÃ¼ psikolojisinden etkilenmem.",
    "BelirlediÄŸim stratejiye sadÄ±k kalÄ±rÄ±m.",
    "DuygularÄ±mÄ± yatÄ±rÄ±m kararlarÄ±ndan ayÄ±rÄ±rÄ±m.",
    "AÅŸÄ±rÄ± Ã¶zgÃ¼venle karar vermekten kaÃ§Ä±nÄ±rÄ±m."
  ]}
];

const ALL_Q=[];
SECTIONS.forEach((s,si)=>s.questions.forEach((q,qi)=>ALL_Q.push({s,si,qi,text:q})));
const TOTAL=ALL_Q.length;

const PROFILES=[
  {min:30,max:74,  name:"Koruma OdaklÄ±",icon:"ğŸ›¡ï¸",
   grad:["#bbf7d0","#22c55e"],color:"#15803d",zone:0,
   desc:"Sermayenizi korumayÄ± Ã¶n planda tutuyorsunuz. KÄ±sa vadeli kayÄ±plar sizi rahatsÄ±z ediyor; gÃ¼venli, istikrarlÄ± varlÄ±klara yÃ¶neliyorsunuz.",
   suggest:"Devlet tahvili, mevduat, altÄ±n ve dÃ¼ÅŸÃ¼k volatiliteli fonlar portfÃ¶yÃ¼nÃ¼zÃ¼n temelini oluÅŸturabilir.",
   alloc:[{l:"Tahvil/Mevduat",p:"50%",c:"#4ade80"},{l:"AltÄ±n",p:"25%",c:"#fbbf24"},{l:"Hisse",p:"15%",c:"#60a5fa"},{l:"DiÄŸer",p:"10%",c:"#a78bfa"}]},
  {min:75,max:104, name:"Dengeli",icon:"âš–ï¸",
   grad:["#fef08a","#f59e0b"],color:"#92400e",zone:1,
   desc:"Risk ve getiriyi dengelemeyi tercih ediyorsunuz. Makul bir getiri iÃ§in sÄ±nÄ±rlÄ± dÃ¼ÅŸÃ¼ÅŸleri kaldÄ±rabilirsiniz.",
   suggest:"Karma portfÃ¶y, temettÃ¼ hisseleri ve orta vadeli tahvillerin birleÅŸimi size uygundur.",
   alloc:[{l:"Hisse",p:"40%",c:"#60a5fa"},{l:"Tahvil",p:"35%",c:"#4ade80"},{l:"AltÄ±n",p:"15%",c:"#fbbf24"},{l:"DiÄŸer",p:"10%",c:"#a78bfa"}]},
  {min:105,max:134,name:"BÃ¼yÃ¼me OdaklÄ±",icon:"ğŸ“ˆ",
   grad:["#bfdbfe","#3b82f6"],color:"#1d4ed8",zone:2,
   desc:"Uzun vadeli bÃ¼yÃ¼me iÃ§in geÃ§ici dalgalanmalarÄ± kaldÄ±rabiliyorsunuz. PiyasayÄ± yakÄ±ndan takip ediyor, bilinÃ§li risk alÄ±yorsunuz.",
   suggest:"Hisse aÄŸÄ±rlÄ±klÄ±, Ã§eÅŸitlendirilmiÅŸ portfÃ¶y. GeliÅŸmekte olan piyasalar ve bÃ¼yÃ¼me hisseleri radarÄ±nÄ±zda olabilir.",
   alloc:[{l:"Hisse",p:"60%",c:"#60a5fa"},{l:"Tahvil",p:"20%",c:"#4ade80"},{l:"AltÄ±n",p:"10%",c:"#fbbf24"},{l:"Kripto/DiÄŸer",p:"10%",c:"#a78bfa"}]},
  {min:135,max:150,name:"Agresif",icon:"ğŸš€",
   grad:["#fecaca","#ef4444"],color:"#b91c1c",zone:3,
   desc:"YÃ¼ksek getiri iÃ§in yÃ¼ksek riski gÃ¶ze alabiliyorsunuz. Volatiliteyi fÄ±rsat olarak gÃ¶rÃ¼yor, uzun vadeli dÃ¼ÅŸÃ¼nÃ¼yorsunuz.",
   suggest:"YÃ¼ksek bÃ¼yÃ¼me potansiyelli hisseler, kripto para ve alternatif yatÄ±rÄ±m araÃ§larÄ± profilinize uygundur.",
   alloc:[{l:"Hisse",p:"70%",c:"#60a5fa"},{l:"Kripto",p:"15%",c:"#a78bfa"},{l:"Tahvil",p:"10%",c:"#4ade80"},{l:"DiÄŸer",p:"5%",c:"#fbbf24"}]}
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let cur=0, ans={}, user=null, radarChart=null;

const card     = document.getElementById("card");
const progWrap = document.getElementById("prog-wrap");
const pFill    = document.getElementById("p-fill");
const pSection = document.getElementById("p-section");
const pNum     = document.getElementById("p-num");
const body     = document.body;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function updateProg(){
  const pct=((cur+1)/TOTAL)*100;
  pFill.style.width=Math.max(pct,3.3)+"%";
  pSection.textContent=ALL_Q[Math.min(cur,TOTAL-1)].s.title;
  pNum.textContent=(cur+1)+" / "+TOTAL;
}

function setQuizMode(){
  body.className="mode-quiz";
  progWrap.style.display="";
  // clear result card if any
  const rc=document.getElementById("result-card");
  if(rc) rc.remove();
}

function setResultMode(){
  body.className="mode-result";
  progWrap.style.display="none";
}

function animCard(anim){
  card.classList.remove("aR","aL","aU","shake");
  void card.offsetWidth;
  if(anim) card.classList.add(anim);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUIZ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderQ(dir){
  updateProg();
  setQuizMode();
  const q=ALL_Q[cur];
  const sel=ans[cur];
  const isLast=cur===TOTAL-1;

  card.innerHTML=`
    <div class="quiz-grid">
      <div class="q-top">
        <div>
          <div class="q-cat">${q.s.title}</div>
          <div class="q-text">${q.text}</div>
        </div>
      </div>
      <div class="scale-wrap">
        <div class="scale-hint">
          <span>1 â€” HiÃ§ rahat deÄŸilim</span>
          <span>5 â€” Ã‡ok rahatÄ±m</span>
        </div>
        <div class="scale-row">
          ${[1,2,3,4,5].map(v=>`<button class="${sel===v?'sel':''}" onclick="pick(${v})">${v}</button>`).join("")}
        </div>
      </div>
      <div class="nav">
        <button class="btn-back" onclick="goBack()" ${cur===0?"disabled":""}>â† Geri</button>
        <button class="btn-next" onclick="goNext()">${isLast?"Sonucu GÃ¶r âœ¦":"Ä°leri â†’"}</button>
      </div>
    </div>`;

  animCard(dir==="right"?"aR":dir==="left"?"aL":null);
}

function pick(v){
  ans[cur]=v;
  // update buttons without animation
  document.querySelectorAll(".scale-row button").forEach((btn,i)=>{
    btn.className=((i+1)===v)?"sel":"";
  });
}

function goNext(){
  if(!ans[cur]){
    card.classList.remove("shake");
    void card.offsetWidth;
    card.classList.add("shake");
    return;
  }
  if(cur<TOTAL-1){cur++;renderQ("right");}
  else showLogin();
}

function goBack(){
  if(cur>0){cur--;renderQ("left");}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showLogin(){
  setQuizMode();
  progWrap.style.display="none";
  card.innerHTML=`
    <div class="login-wrap">
      <h2>Son bir adÄ±m.</h2>
      <p>Sonucunuzu gÃ¶rmek iÃ§in bilgilerinizi girin. Verileriniz yalnÄ±zca profilinizi kaydetmek amacÄ±yla kullanÄ±lÄ±r.</p>
      <input class="field" id="f-name"  type="text"  placeholder="Ad Soyad"       autocomplete="name"/>
      <input class="field" id="f-email" type="email" placeholder="E-posta adresi" autocomplete="email"/>
      <button class="btn-submit" onclick="doLogin()">Sonucumu GÃ¶r â†’</button>
    </div>`;
  animCard("aR");
  setTimeout(()=>{const el=document.getElementById("f-name");if(el)el.focus();},300);
}

function doLogin(){
  const name =(document.getElementById("f-name").value||"").trim();
  const email=(document.getElementById("f-email").value||"").trim();
  if(!name||!email||!email.includes("@")){
    const btn=document.querySelector(".btn-submit");
    btn.style.background="#ef4444";
    btn.textContent="LÃ¼tfen bilgileri doldurun";
    setTimeout(()=>{btn.style.background="";btn.textContent="Sonucumu GÃ¶r â†’";},1400);
    return;
  }
  user={name,email};
  localStorage.setItem("rp_user",JSON.stringify(user));
  const saved=localStorage.getItem("rp_result_"+email);
  if(saved) showResult(JSON.parse(saved));
  else computeResult();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESULT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function computeResult(){
  const total=Object.values(ans).reduce((a,b)=>a+b,0);
  const sectScores=SECTIONS.map((_,si)=>{
    let s=0;
    for(let qi=0;qi<5;qi++) s+=(ans[si*5+qi]||1);
    return Math.round((s/25)*100);
  });
  const prof=PROFILES.find(p=>total>=p.min&&total<=p.max)||PROFILES[PROFILES.length-1];
  const data={
    name:user.name,email:user.email,total,sectScores,
    profile:prof.name,icon:prof.icon,desc:prof.desc,
    suggest:prof.suggest,alloc:prof.alloc,
    color:prof.color,grad:prof.grad,zone:prof.zone,
    date:new Date().toISOString()
  };
  localStorage.setItem("rp_result_"+user.email,JSON.stringify(data));
  showResult(data);
}

function showResult(data){
  setResultMode();
  const pct=Math.round(((data.total-30)/120)*100);
  const zones=["Koruma","Dengeli","BÃ¼yÃ¼me","Agresif"];

  card.innerHTML=`
    <!-- Profile header -->
    <div class="result-header">
      <div class="result-icon">${data.icon}</div>
      <div class="result-info">
        <div class="result-label">Risk Profiliniz</div>
        <div class="result-name">${data.profile}</div>
        <div class="result-score-tag">Skor: ${data.total} / 150</div>
      </div>
    </div>

    <!-- Gauge -->
    <div class="section-block">
      <div class="section-title">Risk Seviyesi</div>
      <div class="gauge-labels"><span>DÃ¼ÅŸÃ¼k Risk</span><span>YÃ¼ksek Risk</span></div>
      <div class="gauge-track">
        <div class="gauge-fill" id="g-fill"
             style="width:0%;background:linear-gradient(90deg,${data.grad[0]},${data.grad[1]})">
        </div>
      </div>
      <div class="zones">
        ${zones.map((z,i)=>`<div class="zone z${i+1}${i===data.zone?" active":""}">${z}</div>`).join("")}
      </div>
    </div>

    <!-- Radar -->
    <div class="section-block">
      <div class="section-title">Kategori BazlÄ± Analiz</div>
      <div class="chart-box"><canvas id="radar-cv"></canvas></div>
    </div>

    <!-- Description -->
    <div class="section-block">
      <div class="desc-block"><b>Profil AÃ§Ä±klamasÄ±</b>${data.desc}</div>
      <div class="desc-block"><b>Ã–nerilen YaklaÅŸÄ±m</b>${data.suggest}</div>
    </div>

    <!-- Alloc -->
    <div class="section-block">
      <div class="section-title" style="margin-bottom:10px">Ã–rnek PortfÃ¶y DaÄŸÄ±lÄ±mÄ±</div>
      <div class="alloc-grid">
        ${(data.alloc||[]).map(a=>`
          <div class="alloc-pill">
            <div class="alloc-dot" style="background:${a.c}"></div>
            <span>${a.l} <strong>${a.p}</strong></span>
          </div>`).join("")}
      </div>
    </div>

    <!-- Restart -->
    <button class="restart-btn" onclick="resetAll()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-4"/>
      </svg>
      Testi Yeniden BaÅŸlat
    </button>
  `;

  animCard("aU");

  // Animate gauge
  requestAnimationFrame(()=>requestAnimationFrame(()=>{
    const f=document.getElementById("g-fill");
    if(f) f.style.width=pct+"%";
    f.style.transition="width 1.1s cubic-bezier(.4,0,.2,1) .3s";
  }));

  // Radar chart
  setTimeout(()=>{
    const cv=document.getElementById("radar-cv");
    if(!cv) return;
    if(radarChart){radarChart.destroy();radarChart=null;}
    radarChart=new Chart(cv,{
      type:"radar",
      data:{
        labels:SECTIONS.map(s=>s.short),
        datasets:[{
          label:"Skorunuz",
          data:data.sectScores,
          fill:true,
          backgroundColor:hexAlpha(data.grad[1],.15),
          borderColor:data.grad[1],
          borderWidth:2,
          pointBackgroundColor:data.grad[1],
          pointRadius:4,
          pointHoverRadius:6
        }]
      },
      options:{
        responsive:true,
        maintainAspectRatio:false,
        layout:{padding:{top:10,bottom:10,left:10,right:10}},
        plugins:{
          legend:{display:false},
          tooltip:{callbacks:{label:c=>` ${c.raw}%`}}
        },
        scales:{r:{
          min:0,max:100,
          ticks:{stepSize:25,font:{size:9},color:"#9aa5b4",backdropColor:"transparent"},
          grid:{color:"#e2e8f0"},
          angleLines:{color:"#e2e8f0"},
          pointLabels:{
            font:{size:11,family:"'Inter',sans-serif",weight:"600"},
            color:"#4a5568",
            padding:8
          }
        }}
      }
    });
  },350);
}

function hexAlpha(hex,a){
  const r=parseInt(hex.slice(1,3),16);
  const g=parseInt(hex.slice(3,5),16);
  const b=parseInt(hex.slice(5,7),16);
  return`rgba(${r},${g},${b},${a})`;
}

function resetAll(){
  if(radarChart){radarChart.destroy();radarChart=null;}
  if(user) localStorage.removeItem("rp_result_"+user.email);
  ans={};cur=0;user=null;
  renderQ("right");
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function(){
  const su=localStorage.getItem("rp_user");
  if(su){
    user=JSON.parse(su);
    const sr=localStorage.getItem("rp_result_"+user.email);
    if(sr){showResult(JSON.parse(sr));return;}
  }
  renderQ("right");
})();
</script>
</body>
</html>
