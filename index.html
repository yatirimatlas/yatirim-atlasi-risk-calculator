<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Risk Profili Analizi | Yatırım Atlası</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
html,body{
margin:0;
padding:0;
background:#f3f4f6;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
overflow-x:hidden;
}
</style>
</head>
<body>

<div class="flex justify-center px-4 py-8">
<div id="app" class="w-full max-w-3xl"></div>
</div>

<script>

/* ---------- WIX AUTO HEIGHT ---------- */
function sendHeight(){
window.parent.postMessage(document.documentElement.scrollHeight,"*");
}
window.addEventListener("load",sendHeight);
window.addEventListener("resize",sendHeight);

/* ---------- DATA ---------- */

const sections=[
{
title:"Risk Algısı",
questions:[
"Piyasa %20 düştüğünde pozisyonumu koruyabilirim.",
"Geçici zararlar beni paniğe sürüklemez.",
"Dalgalı piyasalarda sakin kalırım.",
"Portföy düşüşlerinde stratejimi bozmayarım.",
"Belirsizlik dönemlerinde yatırım yapabilirim."
]},
{
title:"Volatilite Toleransı",
questions:[
"Yüksek getiri için risk alabilirim.",
"Günlük fiyat değişimleri beni rahatsız etmez.",
"Agresif yatırım araçlarına açığım.",
"Kısa vadeli kayıpları tolere edebilirim.",
"Oynaklık fırsat yaratır."
]},
{
title:"Zaman Ufku",
questions:[
"Yatırımlarımı uzun vadeli planlarım.",
"En az 5 yıl yatırımda kalabilirim.",
"Sabırlı bir yatırımcıyım.",
"Kısa vadeli kazanç önceliğim değildir.",
"Uzun süre bekleyebilirim."
]},
{
title:"Finansal Dayanıklılık",
questions:[
"Acil durum fonum var.",
"Borç oranım düşük.",
"Gelirim düzenli.",
"Yatırım zararları hayatımı etkilemez.",
"Nakit ihtiyacım düşük."
]},
{
title:"Bilgi ve Deneyim",
questions:[
"Piyasa bilgim var.",
"Daha önce yatırım yaptım.",
"Risk-getiri ilişkisini bilirim.",
"Farklı varlık türlerini tanırım.",
"Piyasa analizlerini takip ederim."
]},
{
title:"Davranışsal Disiplin",
questions:[
"Panik satış yapmam.",
"Sürü psikolojisinden etkilenmem.",
"Stratejime sadık kalırım.",
"Duygularımı kontrol ederim.",
"Aşırı özgüvenli karar almam."
]}
];

const profiles=[
{min:30,max:75,name:"Koruma Odaklı"},
{min:76,max:110,name:"Dengeli"},
{min:111,max:150,name:"Büyüme Odaklı"},
{min:151,max:180,name:"Agresif"}
];

let currentSection=0;
let answers={};
let currentUser=null;

const app=document.getElementById("app");

/* ---------- QUIZ ---------- */

function renderQuiz(){

const section=sections[currentSection];

app.innerHTML=`
<div class="bg-white shadow-xl rounded-3xl p-8">
<h2 class="text-xl font-bold mb-4">
${section.title} (${currentSection+1}/${sections.length})
</h2>

<div class="space-y-5">
${section.questions.map((q,i)=>`
<div>
<p class="mb-2">${q}</p>
<div class="flex justify-between text-xs text-gray-400 mb-1">
<span>Hiç rahat değilim</span>
<span>Son derece rahatım</span>
</div>
<div class="flex gap-2">
${[1,2,3,4,5].map(v=>`
<button onclick="answer(${currentSection},${i},${v})"
class="flex-1 py-2 rounded-xl border 
${answers[`${currentSection}-${i}`]==v?'bg-black text-white':'bg-white'}">
${v}
</button>`).join("")}
</div>
</div>`).join("")}
</div>

<div class="mt-6 flex justify-between">
<button onclick="prev()" class="px-4 py-2 bg-gray-200 rounded-xl">Geri</button>
<button onclick="next()" class="px-4 py-2 bg-black text-white rounded-xl">
${currentSection===sections.length-1?'Sonucu Gör':'İleri'}
</button>
</div>
</div>
`;

sendHeight();
}

function answer(s,i,v){
answers[`${s}-${i}`]=v;
renderQuiz();
}

function prev(){
if(currentSection>0){
currentSection--;
renderQuiz();
}
}

function next(){
const sec=sections[currentSection];
for(let i=0;i<sec.questions.length;i++){
if(!answers[`${currentSection}-${i}`]){
alert("Tüm soruları cevaplayın.");
return;
}
}

if(currentSection===sections.length-1){
showLogin();
}else{
currentSection++;
renderQuiz();
}
}

/* ---------- LOGIN ---------- */

function showLogin(){
app.innerHTML=`
<div class="bg-white shadow-xl rounded-3xl p-8">
<h2 class="text-xl font-bold mb-4">Sonucu Görmek İçin Giriş Yapın</h2>
<input id="name" placeholder="Ad Soyad"
class="w-full mb-3 p-3 border rounded-xl"/>
<input id="email" placeholder="Email"
class="w-full mb-4 p-3 border rounded-xl"/>
<button onclick="login()"
class="w-full py-3 bg-black text-white rounded-xl">
Giriş Yap
</button>
</div>
`;
sendHeight();
}

function login(){
const name=document.getElementById("name").value.trim();
const email=document.getElementById("email").value.trim();
if(!name||!email){alert("Bilgileri doldurun.");return;}
currentUser={name,email};
showResult();
}

/* ---------- RESULT ---------- */

function showResult(){

let total=Object.values(answers)
.reduce((a,b)=>a+b,0);

let profile=profiles.find(p=>total>=p.min&&total<=p.max);

const data={
name:currentUser.name,
email:currentUser.email,
total,
profile:profile.name,
date:new Date().toISOString()
};

localStorage.setItem(
"riskResult_"+currentUser.email,
JSON.stringify(data)
);

app.innerHTML=`
<div class="bg-white shadow-xl rounded-3xl p-8">
<h2 class="text-2xl font-bold mb-4">
Merhaba ${data.name}
</h2>

<div class="p-6 bg-black text-white rounded-2xl mb-6">
<h3 class="text-xl font-bold">${data.profile}</h3>
<p class="mt-2">Toplam Skor: ${data.total} / 180</p>
</div>

<button onclick="resetAll()"
class="px-5 py-2 bg-red-500 text-white rounded-xl">
Testi Sıfırla
</button>
</div>
`;

sendHeight();
}

function resetAll(){
answers={};
currentSection=0;
renderQuiz();
}

/* ---------- INIT ---------- */

renderQuiz();

</script>
</body>
</html>
